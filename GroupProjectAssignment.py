from z3 import Int, Sum, And, Optimize, Model
import sys
import time

start_time = time.time()

# removes recursion limit for dealing with larger amounts of students
sys.setrecursionlimit(100000)

# input : list of students, represented as a list of list of ints (likert scores of preferences for project topics)
# example: 250 students, 35 groups (5*7 topics) each with score 0-10
students = [
  [6,6,6,6,6,2,2,2,2,2,7,7,7,7,7,8,8,8,8,8,6,6,6,6,6,7,7,7,7,7,9,9,9,9,9],
  [5,5,5,5,5,2,2,2,2,2,9,9,9,9,9,8,8,8,8,8,3,3,3,3,3,3,3,3,3,3,8,8,8,8,8],
  [10,10,10,10,10,6,6,6,6,6,4,4,4,4,4,7,7,7,7,7,3,3,3,3,3,1,1,1,1,1,8,8,8,8,8],
  [5,5,5,5,5,2,2,2,2,2,7,7,7,7,7,5,5,5,5,5,4,4,4,4,4,7,7,7,7,7,4,4,4,4,4],
  [10,10,10,10,10,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,8,8,8,8,8],
  [9,9,9,9,9,9,9,9,9,9,3,3,3,3,3,7,7,7,7,7,9,9,9,9,9,10,10,10,10,10,5,5,5,5,5],
  [1,1,1,1,1,9,9,9,9,9,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,10,10,10,10,10,1,1,1,1,1],
  [8,8,8,8,8,10,10,10,10,10,2,2,2,2,2,9,9,9,9,9,1,1,1,1,1,6,6,6,6,6,6,6,6,6,6],
  [5,5,5,5,5,9,9,9,9,9,5,5,5,5,5,2,2,2,2,2,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7],
  [3,3,3,3,3,10,10,10,10,10,9,9,9,9,9,9,9,9,9,9,6,6,6,6,6,4,4,4,4,4,1,1,1,1,1],
  [8,8,8,8,8,6,6,6,6,6,8,8,8,8,8,6,6,6,6,6,9,9,9,9,9,3,3,3,3,3,5,5,5,5,5],
  [2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,9,9,9,9,9,1,1,1,1,1,10,10,10,10,10,3,3,3,3,3],
  [7,7,7,7,7,9,9,9,9,9,9,9,9,9,9,4,4,4,4,4,6,6,6,6,6,7,7,7,7,7,5,5,5,5,5],
  [1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,9,9,9,9,9,3,3,3,3,3,2,2,2,2,2,3,3,3,3,3],
  [10,10,10,10,10,7,7,7,7,7,7,7,7,7,7,1,1,1,1,1,7,7,7,7,7,8,8,8,8,8,1,1,1,1,1],
  [8,8,8,8,8,9,9,9,9,9,3,3,3,3,3,4,4,4,4,4,8,8,8,8,8,4,4,4,4,4,5,5,5,5,5],
  [2,2,2,2,2,6,6,6,6,6,5,5,5,5,5,1,1,1,1,1,2,2,2,2,2,8,8,8,8,8,9,9,9,9,9],
  [4,4,4,4,4,5,5,5,5,5,8,8,8,8,8,2,2,2,2,2,1,1,1,1,1,6,6,6,6,6,9,9,9,9,9],
  [1,1,1,1,1,2,2,2,2,2,7,7,7,7,7,9,9,9,9,9,10,10,10,10,10,8,8,8,8,8,7,7,7,7,7],
  [6,6,6,6,6,6,6,6,6,6,9,9,9,9,9,2,2,2,2,2,3,3,3,3,3,1,1,1,1,1,9,9,9,9,9],
  [4,4,4,4,4,1,1,1,1,1,6,6,6,6,6,9,9,9,9,9,1,1,1,1,1,8,8,8,8,8,9,9,9,9,9],
  [8,8,8,8,8,7,7,7,7,7,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,6,6,6,6,6,1,1,1,1,1],
  [2,2,2,2,2,10,10,10,10,10,4,4,4,4,4,5,5,5,5,5,3,3,3,3,3,6,6,6,6,6,6,6,6,6,6],
  [4,4,4,4,4,1,1,1,1,1,9,9,9,9,9,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,6,6,6,6,6],
  [8,8,8,8,8,9,9,9,9,9,6,6,6,6,6,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4],
  [6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,2,2,2,2,2,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1],
  [9,9,9,9,9,7,7,7,7,7,6,6,6,6,6,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7,6,6,6,6,6],
  [5,5,5,5,5,1,1,1,1,1,10,10,10,10,10,8,8,8,8,8,8,8,8,8,8,6,6,6,6,6,3,3,3,3,3],
  [7,7,7,7,7,3,3,3,3,3,5,5,5,5,5,1,1,1,1,1,4,4,4,4,4,7,7,7,7,7,6,6,6,6,6],
  [7,7,7,7,7,1,1,1,1,1,8,8,8,8,8,2,2,2,2,2,8,8,8,8,8,1,1,1,1,1,9,9,9,9,9],
  [4,4,4,4,4,6,6,6,6,6,5,5,5,5,5,3,3,3,3,3,8,8,8,8,8,4,4,4,4,4,8,8,8,8,8],
  [4,4,4,4,4,3,3,3,3,3,1,1,1,1,1,9,9,9,9,9,10,10,10,10,10,6,6,6,6,6,5,5,5,5,5],
  [8,8,8,8,8,8,8,8,8,8,4,4,4,4,4,7,7,7,7,7,5,5,5,5,5,7,7,7,7,7,4,4,4,4,4],
  [1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,9,9,9,9,9,1,1,1,1,1,5,5,5,5,5,6,6,6,6,6],
  [4,4,4,4,4,2,2,2,2,2,7,7,7,7,7,2,2,2,2,2,1,1,1,1,1,10,10,10,10,10,4,4,4,4,4],
  [5,5,5,5,5,7,7,7,7,7,5,5,5,5,5,9,9,9,9,9,8,8,8,8,8,7,7,7,7,7,4,4,4,4,4],
  [6,6,6,6,6,2,2,2,2,2,6,6,6,6,6,3,3,3,3,3,2,2,2,2,2,8,8,8,8,8,3,3,3,3,3],
  [3,3,3,3,3,8,8,8,8,8,5,5,5,5,5,3,3,3,3,3,6,6,6,6,6,8,8,8,8,8,4,4,4,4,4],
  [5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,3,3,3,3,3,7,7,7,7,7,9,9,9,9,9,3,3,3,3,3],
  [10,10,10,10,10,6,6,6,6,6,3,3,3,3,3,8,8,8,8,8,7,7,7,7,7,2,2,2,2,2,7,7,7,7,7],
  [7,7,7,7,7,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,5,5,5,5,5,8,8,8,8,8,8,8,8,8,8],
  [3,3,3,3,3,4,4,4,4,4,9,9,9,9,9,2,2,2,2,2,7,7,7,7,7,9,9,9,9,9,3,3,3,3,3],
  [9,9,9,9,9,4,4,4,4,4,5,5,5,5,5,8,8,8,8,8,8,8,8,8,8,10,10,10,10,10,4,4,4,4,4],
  [6,6,6,6,6,3,3,3,3,3,6,6,6,6,6,2,2,2,2,2,8,8,8,8,8,1,1,1,1,1,5,5,5,5,5],
  [9,9,9,9,9,9,9,9,9,9,3,3,3,3,3,6,6,6,6,6,3,3,3,3,3,10,10,10,10,10,1,1,1,1,1],
  [7,7,7,7,7,8,8,8,8,8,5,5,5,5,5,2,2,2,2,2,6,6,6,6,6,2,2,2,2,2,8,8,8,8,8],
  [10,10,10,10,10,2,2,2,2,2,1,1,1,1,1,5,5,5,5,5,4,4,4,4,4,6,6,6,6,6,10,10,10,10,10],
  [1,1,1,1,1,2,2,2,2,2,8,8,8,8,8,4,4,4,4,4,10,10,10,10,10,9,9,9,9,9,6,6,6,6,6],
  [5,5,5,5,5,9,9,9,9,9,6,6,6,6,6,8,8,8,8,8,2,2,2,2,2,5,5,5,5,5,8,8,8,8,8],
  [7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,2,2,2,2,2,10,10,10,10,10,6,6,6,6,6,8,8,8,8,8],
  [3,3,3,3,3,1,1,1,1,1,7,7,7,7,7,1,1,1,1,1,10,10,10,10,10,9,9,9,9,9,6,6,6,6,6],
  [2,2,2,2,2,7,7,7,7,7,1,1,1,1,1,1,1,1,1,1,6,6,6,6,6,10,10,10,10,10,7,7,7,7,7],
  [1,1,1,1,1,4,4,4,4,4,6,6,6,6,6,6,6,6,6,6,1,1,1,1,1,9,9,9,9,9,2,2,2,2,2],
  [5,5,5,5,5,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5],
  [5,5,5,5,5,6,6,6,6,6,2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,8,8,8,8,8,3,3,3,3,3],
  [6,6,6,6,6,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,7,7,7,7,7,1,1,1,1,1,4,4,4,4,4],
  [9,9,9,9,9,3,3,3,3,3,7,7,7,7,7,2,2,2,2,2,2,2,2,2,2,10,10,10,10,10,9,9,9,9,9],
  [10,10,10,10,10,8,8,8,8,8,6,6,6,6,6,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,2,2,2,2,2],
  [7,7,7,7,7,7,7,7,7,7,9,9,9,9,9,10,10,10,10,10,7,7,7,7,7,3,3,3,3,3,9,9,9,9,9],
  [3,3,3,3,3,9,9,9,9,9,3,3,3,3,3,4,4,4,4,4,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7],
  [7,7,7,7,7,9,9,9,9,9,10,10,10,10,10,3,3,3,3,3,10,10,10,10,10,5,5,5,5,5,5,5,5,5,5],
  [3,3,3,3,3,10,10,10,10,10,10,10,10,10,10,1,1,1,1,1,7,7,7,7,7,4,4,4,4,4,6,6,6,6,6],
  [7,7,7,7,7,3,3,3,3,3,4,4,4,4,4,7,7,7,7,7,9,9,9,9,9,5,5,5,5,5,5,5,5,5,5],
  [5,5,5,5,5,3,3,3,3,3,5,5,5,5,5,7,7,7,7,7,3,3,3,3,3,7,7,7,7,7,10,10,10,10,10],
  [5,5,5,5,5,8,8,8,8,8,2,2,2,2,2,1,1,1,1,1,3,3,3,3,3,6,6,6,6,6,8,8,8,8,8],
  [1,1,1,1,1,4,4,4,4,4,2,2,2,2,2,6,6,6,6,6,9,9,9,9,9,5,5,5,5,5,7,7,7,7,7],
  [1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,4,4,4,4,4,1,1,1,1,1,2,2,2,2,2,1,1,1,1,1],
  [5,5,5,5,5,2,2,2,2,2,6,6,6,6,6,2,2,2,2,2,5,5,5,5,5,4,4,4,4,4,8,8,8,8,8],
  [9,9,9,9,9,7,7,7,7,7,1,1,1,1,1,5,5,5,5,5,10,10,10,10,10,3,3,3,3,3,6,6,6,6,6],
  [3,3,3,3,3,1,1,1,1,1,4,4,4,4,4,6,6,6,6,6,6,6,6,6,6,2,2,2,2,2,1,1,1,1,1],
  [3,3,3,3,3,5,5,5,5,5,7,7,7,7,7,10,10,10,10,10,4,4,4,4,4,10,10,10,10,10,1,1,1,1,1],
  [5,5,5,5,5,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,6,6,6,6,6,7,7,7,7,7,4,4,4,4,4],
  [2,2,2,2,2,3,3,3,3,3,6,6,6,6,6,8,8,8,8,8,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8],
  [9,9,9,9,9,9,9,9,9,9,3,3,3,3,3,3,3,3,3,3,8,8,8,8,8,3,3,3,3,3,10,10,10,10,10],
  [3,3,3,3,3,8,8,8,8,8,10,10,10,10,10,7,7,7,7,7,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],
  [6,6,6,6,6,3,3,3,3,3,3,3,3,3,3,6,6,6,6,6,8,8,8,8,8,1,1,1,1,1,3,3,3,3,3],
  [10,10,10,10,10,4,4,4,4,4,2,2,2,2,2,8,8,8,8,8,2,2,2,2,2,10,10,10,10,10,10,10,10,10,10],
  [10,10,10,10,10,3,3,3,3,3,6,6,6,6,6,10,10,10,10,10,9,9,9,9,9,6,6,6,6,6,1,1,1,1,1],
  [7,7,7,7,7,1,1,1,1,1,2,2,2,2,2,6,6,6,6,6,1,1,1,1,1,8,8,8,8,8,3,3,3,3,3],
  [8,8,8,8,8,6,6,6,6,6,6,6,6,6,6,1,1,1,1,1,6,6,6,6,6,1,1,1,1,1,10,10,10,10,10],
  [4,4,4,4,4,6,6,6,6,6,7,7,7,7,7,3,3,3,3,3,10,10,10,10,10,2,2,2,2,2,1,1,1,1,1],
  [4,4,4,4,4,4,4,4,4,4,8,8,8,8,8,6,6,6,6,6,7,7,7,7,7,3,3,3,3,3,10,10,10,10,10],
  [2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,2,2,2,2,2,7,7,7,7,7,7,7,7,7,7,10,10,10,10,10],
  [10,10,10,10,10,2,2,2,2,2,8,8,8,8,8,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,6,6,6,6,6],
  [6,6,6,6,6,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,10,10,10,10,10,2,2,2,2,2,4,4,4,4,4],
  [8,8,8,8,8,9,9,9,9,9,1,1,1,1,1,7,7,7,7,7,6,6,6,6,6,4,4,4,4,4,5,5,5,5,5],
  [2,2,2,2,2,6,6,6,6,6,9,9,9,9,9,10,10,10,10,10,7,7,7,7,7,2,2,2,2,2,9,9,9,9,9],
  [3,3,3,3,3,9,9,9,9,9,8,8,8,8,8,6,6,6,6,6,3,3,3,3,3,7,7,7,7,7,4,4,4,4,4],
  [8,8,8,8,8,5,5,5,5,5,3,3,3,3,3,2,2,2,2,2,9,9,9,9,9,8,8,8,8,8,3,3,3,3,3],
  [2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,9,9,9,9,9,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9],
  [6,6,6,6,6,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,8,8,8,8,8,2,2,2,2,2],
  [6,6,6,6,6,7,7,7,7,7,10,10,10,10,10,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,6,6,6,6,6],
  [5,5,5,5,5,4,4,4,4,4,9,9,9,9,9,10,10,10,10,10,2,2,2,2,2,7,7,7,7,7,3,3,3,3,3],
  [7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,5,5,5,5,5],
  [10,10,10,10,10,7,7,7,7,7,8,8,8,8,8,5,5,5,5,5,7,7,7,7,7,6,6,6,6,6,5,5,5,5,5],
  [9,9,9,9,9,1,1,1,1,1,6,6,6,6,6,8,8,8,8,8,5,5,5,5,5,10,10,10,10,10,1,1,1,1,1],
  [5,5,5,5,5,2,2,2,2,2,6,6,6,6,6,1,1,1,1,1,4,4,4,4,4,9,9,9,9,9,7,7,7,7,7],
  [8,8,8,8,8,2,2,2,2,2,7,7,7,7,7,3,3,3,3,3,1,1,1,1,1,4,4,4,4,4,6,6,6,6,6],
  [6,6,6,6,6,6,6,6,6,6,3,3,3,3,3,6,6,6,6,6,3,3,3,3,3,6,6,6,6,6,7,7,7,7,7],
  [4,4,4,4,4,9,9,9,9,9,5,5,5,5,5,5,5,5,5,5,1,1,1,1,1,4,4,4,4,4,5,5,5,5,5],
  [4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,7,7,7,7,7,10,10,10,10,10,8,8,8,8,8,7,7,7,7,7],
  [3,3,3,3,3,4,4,4,4,4,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,6,6,6,6,6,4,4,4,4,4],
  [1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,3,3,3,3,3,9,9,9,9,9,2,2,2,2,2,5,5,5,5,5],
  [9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,3,3,3,3,3],
  [7,7,7,7,7,7,7,7,7,7,1,1,1,1,1,10,10,10,10,10,4,4,4,4,4,6,6,6,6,6,9,9,9,9,9],
  [2,2,2,2,2,5,5,5,5,5,7,7,7,7,7,2,2,2,2,2,8,8,8,8,8,1,1,1,1,1,1,1,1,1,1],
  [6,6,6,6,6,1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,7,7,7,7,7,9,9,9,9,9,1,1,1,1,1],
  [3,3,3,3,3,2,2,2,2,2,9,9,9,9,9,2,2,2,2,2,4,4,4,4,4,8,8,8,8,8,5,5,5,5,5],
  [8,8,8,8,8,1,1,1,1,1,7,7,7,7,7,3,3,3,3,3,7,7,7,7,7,9,9,9,9,9,3,3,3,3,3],
  [4,4,4,4,4,3,3,3,3,3,5,5,5,5,5,1,1,1,1,1,5,5,5,5,5,9,9,9,9,9,9,9,9,9,9],
  [4,4,4,4,4,9,9,9,9,9,7,7,7,7,7,3,3,3,3,3,9,9,9,9,9,4,4,4,4,4,3,3,3,3,3],
  [2,2,2,2,2,1,1,1,1,1,9,9,9,9,9,4,4,4,4,4,4,4,4,4,4,9,9,9,9,9,3,3,3,3,3],
  [10,10,10,10,10,7,7,7,7,7,8,8,8,8,8,5,5,5,5,5,1,1,1,1,1,7,7,7,7,7,1,1,1,1,1],
  [5,5,5,5,5,10,10,10,10,10,5,5,5,5,5,3,3,3,3,3,4,4,4,4,4,9,9,9,9,9,5,5,5,5,5],
  [5,5,5,5,5,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,3,3,3,3,3,1,1,1,1,1],
  [7,7,7,7,7,1,1,1,1,1,8,8,8,8,8,6,6,6,6,6,5,5,5,5,5,9,9,9,9,9,10,10,10,10,10],
  [9,9,9,9,9,2,2,2,2,2,10,10,10,10,10,4,4,4,4,4,2,2,2,2,2,10,10,10,10,10,9,9,9,9,9],
  [6,6,6,6,6,9,9,9,9,9,8,8,8,8,8,9,9,9,9,9,6,6,6,6,6,7,7,7,7,7,6,6,6,6,6],
  [6,6,6,6,6,2,2,2,2,2,3,3,3,3,3,6,6,6,6,6,9,9,9,9,9,10,10,10,10,10,2,2,2,2,2],
  [5,5,5,5,5,5,5,5,5,5,8,8,8,8,8,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8],
  [9,9,9,9,9,4,4,4,4,4,3,3,3,3,3,9,9,9,9,9,4,4,4,4,4,7,7,7,7,7,10,10,10,10,10],
  [4,4,4,4,4,3,3,3,3,3,10,10,10,10,10,4,4,4,4,4,6,6,6,6,6,1,1,1,1,1,4,4,4,4,4],
  [6,6,6,6,6,10,10,10,10,10,5,5,5,5,5,7,7,7,7,7,3,3,3,3,3,2,2,2,2,2,10,10,10,10,10],
  [10,10,10,10,10,4,4,4,4,4,1,1,1,1,1,2,2,2,2,2,10,10,10,10,10,2,2,2,2,2,5,5,5,5,5],
  [1,1,1,1,1,6,6,6,6,6,9,9,9,9,9,2,2,2,2,2,1,1,1,1,1,10,10,10,10,10,6,6,6,6,6],
  [10,10,10,10,10,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,6,6,6,6,6,9,9,9,9,9],
  [8,8,8,8,8,2,2,2,2,2,3,3,3,3,3,1,1,1,1,1,10,10,10,10,10,3,3,3,3,3,4,4,4,4,4],
  [4,4,4,4,4,5,5,5,5,5,1,1,1,1,1,10,10,10,10,10,9,9,9,9,9,5,5,5,5,5,3,3,3,3,3],
  [5,5,5,5,5,10,10,10,10,10,6,6,6,6,6,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7],
  [7,7,7,7,7,6,6,6,6,6,7,7,7,7,7,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4],
  [5,5,5,5,5,3,3,3,3,3,10,10,10,10,10,5,5,5,5,5,4,4,4,4,4,9,9,9,9,9,5,5,5,5,5],
  [4,4,4,4,4,5,5,5,5,5,2,2,2,2,2,1,1,1,1,1,6,6,6,6,6,1,1,1,1,1,8,8,8,8,8],
  [4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,6,6,6,6,6,2,2,2,2,2,10,10,10,10,10,4,4,4,4,4],
  [5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,9,9,9,9,9],
  [4,4,4,4,4,10,10,10,10,10,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,7,7,7,7,7,2,2,2,2,2],
  [8,8,8,8,8,8,8,8,8,8,10,10,10,10,10,8,8,8,8,8,9,9,9,9,9,8,8,8,8,8,7,7,7,7,7],
  [2,2,2,2,2,5,5,5,5,5,6,6,6,6,6,4,4,4,4,4,9,9,9,9,9,10,10,10,10,10,4,4,4,4,4],
  [5,5,5,5,5,9,9,9,9,9,6,6,6,6,6,5,5,5,5,5,10,10,10,10,10,5,5,5,5,5,6,6,6,6,6],
  [5,5,5,5,5,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,10,10,10,10,10,4,4,4,4,4],
  [1,1,1,1,1,8,8,8,8,8,10,10,10,10,10,8,8,8,8,8,4,4,4,4,4,4,4,4,4,4,9,9,9,9,9],
  [5,5,5,5,5,5,5,5,5,5,10,10,10,10,10,2,2,2,2,2,7,7,7,7,7,8,8,8,8,8,1,1,1,1,1],
  [8,8,8,8,8,10,10,10,10,10,3,3,3,3,3,1,1,1,1,1,5,5,5,5,5,10,10,10,10,10,6,6,6,6,6],
  [6,6,6,6,6,9,9,9,9,9,6,6,6,6,6,5,5,5,5,5,9,9,9,9,9,8,8,8,8,8,8,8,8,8,8],
  [8,8,8,8,8,4,4,4,4,4,5,5,5,5,5,2,2,2,2,2,7,7,7,7,7,5,5,5,5,5,5,5,5,5,5],
  [2,2,2,2,2,8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,7,7,7,7,7,5,5,5,5,5],
  [8,8,8,8,8,3,3,3,3,3,2,2,2,2,2,7,7,7,7,7,3,3,3,3,3,4,4,4,4,4,2,2,2,2,2],
  [1,1,1,1,1,9,9,9,9,9,7,7,7,7,7,4,4,4,4,4,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9],
  [4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,10,10,10,10,10,6,6,6,6,6,3,3,3,3,3,10,10,10,10,10],
  [8,8,8,8,8,1,1,1,1,1,9,9,9,9,9,3,3,3,3,3,4,4,4,4,4,1,1,1,1,1,10,10,10,10,10],
  [2,2,2,2,2,4,4,4,4,4,3,3,3,3,3,9,9,9,9,9,2,2,2,2,2,5,5,5,5,5,6,6,6,6,6],
  [10,10,10,10,10,2,2,2,2,2,3,3,3,3,3,7,7,7,7,7,4,4,4,4,4,9,9,9,9,9,1,1,1,1,1],
  [8,8,8,8,8,5,5,5,5,5,1,1,1,1,1,2,2,2,2,2,4,4,4,4,4,7,7,7,7,7,4,4,4,4,4],
  [2,2,2,2,2,4,4,4,4,4,2,2,2,2,2,8,8,8,8,8,7,7,7,7,7,6,6,6,6,6,5,5,5,5,5],
  [4,4,4,4,4,6,6,6,6,6,10,10,10,10,10,3,3,3,3,3,5,5,5,5,5,10,10,10,10,10,9,9,9,9,9],
  [7,7,7,7,7,5,5,5,5,5,1,1,1,1,1,7,7,7,7,7,3,3,3,3,3,10,10,10,10,10,10,10,10,10,10],
  [8,8,8,8,8,2,2,2,2,2,2,2,2,2,2,9,9,9,9,9,4,4,4,4,4,9,9,9,9,9,3,3,3,3,3],
  [7,7,7,7,7,1,1,1,1,1,4,4,4,4,4,5,5,5,5,5,7,7,7,7,7,4,4,4,4,4,2,2,2,2,2],
  [7,7,7,7,7,7,7,7,7,7,10,10,10,10,10,10,10,10,10,10,2,2,2,2,2,1,1,1,1,1,2,2,2,2,2],
  [4,4,4,4,4,6,6,6,6,6,9,9,9,9,9,2,2,2,2,2,5,5,5,5,5,8,8,8,8,8,7,7,7,7,7],
  [1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,2,2,2,2,2,6,6,6,6,6,5,5,5,5,5],
  [9,9,9,9,9,5,5,5,5,5,3,3,3,3,3,1,1,1,1,1,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9],
  [1,1,1,1,1,10,10,10,10,10,3,3,3,3,3,8,8,8,8,8,10,10,10,10,10,6,6,6,6,6,6,6,6,6,6],
  [9,9,9,9,9,8,8,8,8,8,8,8,8,8,8,6,6,6,6,6,3,3,3,3,3,1,1,1,1,1,7,7,7,7,7],
  [1,1,1,1,1,4,4,4,4,4,2,2,2,2,2,3,3,3,3,3,10,10,10,10,10,1,1,1,1,1,7,7,7,7,7],
  [1,1,1,1,1,9,9,9,9,9,7,7,7,7,7,1,1,1,1,1,6,6,6,6,6,9,9,9,9,9,8,8,8,8,8],
  [5,5,5,5,5,4,4,4,4,4,1,1,1,1,1,3,3,3,3,3,4,4,4,4,4,10,10,10,10,10,8,8,8,8,8],
  [8,8,8,8,8,10,10,10,10,10,9,9,9,9,9,9,9,9,9,9,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7],
  [3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,10,10,10,10,10,10,10,10,10,10,6,6,6,6,6,4,4,4,4,4],
  [9,9,9,9,9,8,8,8,8,8,4,4,4,4,4,1,1,1,1,1,10,10,10,10,10,4,4,4,4,4,4,4,4,4,4],
  [4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,9,9,9,9,9,8,8,8,8,8,6,6,6,6,6,3,3,3,3,3],
  [10,10,10,10,10,1,1,1,1,1,10,10,10,10,10,9,9,9,9,9,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3],
  [7,7,7,7,7,3,3,3,3,3,6,6,6,6,6,6,6,6,6,6,2,2,2,2,2,2,2,2,2,2,10,10,10,10,10],
  [7,7,7,7,7,1,1,1,1,1,7,7,7,7,7,9,9,9,9,9,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8],
  [6,6,6,6,6,1,1,1,1,1,7,7,7,7,7,5,5,5,5,5,2,2,2,2,2,10,10,10,10,10,4,4,4,4,4],
  [3,3,3,3,3,5,5,5,5,5,8,8,8,8,8,8,8,8,8,8,5,5,5,5,5,2,2,2,2,2,3,3,3,3,3],
  [3,3,3,3,3,6,6,6,6,6,1,1,1,1,1,6,6,6,6,6,9,9,9,9,9,5,5,5,5,5,10,10,10,10,10],
  [6,6,6,6,6,3,3,3,3,3,6,6,6,6,6,3,3,3,3,3,7,7,7,7,7,9,9,9,9,9,8,8,8,8,8],
  [2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,6,6,6,6,6,5,5,5,5,5,7,7,7,7,7,5,5,5,5,5],
  [7,7,7,7,7,7,7,7,7,7,2,2,2,2,2,4,4,4,4,4,10,10,10,10,10,1,1,1,1,1,2,2,2,2,2],
  [6,6,6,6,6,10,10,10,10,10,8,8,8,8,8,10,10,10,10,10,9,9,9,9,9,7,7,7,7,7,9,9,9,9,9],
  [1,1,1,1,1,2,2,2,2,2,7,7,7,7,7,9,9,9,9,9,5,5,5,5,5,8,8,8,8,8,9,9,9,9,9],
  [6,6,6,6,6,7,7,7,7,7,5,5,5,5,5,1,1,1,1,1,8,8,8,8,8,1,1,1,1,1,6,6,6,6,6],
  [5,5,5,5,5,1,1,1,1,1,7,7,7,7,7,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3],
  [8,8,8,8,8,1,1,1,1,1,9,9,9,9,9,8,8,8,8,8,1,1,1,1,1,5,5,5,5,5,5,5,5,5,5],
  [9,9,9,9,9,8,8,8,8,8,2,2,2,2,2,10,10,10,10,10,9,9,9,9,9,9,9,9,9,9,4,4,4,4,4],
  [9,9,9,9,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,6,6,6,6,6,4,4,4,4,4],
  [9,9,9,9,9,9,9,9,9,9,5,5,5,5,5,5,5,5,5,5,2,2,2,2,2,9,9,9,9,9,1,1,1,1,1],
  [4,4,4,4,4,6,6,6,6,6,2,2,2,2,2,1,1,1,1,1,8,8,8,8,8,10,10,10,10,10,8,8,8,8,8],
  [10,10,10,10,10,8,8,8,8,8,7,7,7,7,7,8,8,8,8,8,6,6,6,6,6,5,5,5,5,5,8,8,8,8,8],
  [6,6,6,6,6,6,6,6,6,6,2,2,2,2,2,4,4,4,4,4,7,7,7,7,7,3,3,3,3,3,6,6,6,6,6],
  [5,5,5,5,5,6,6,6,6,6,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,1,1,1,1,1,10,10,10,10,10],
  [9,9,9,9,9,7,7,7,7,7,5,5,5,5,5,2,2,2,2,2,6,6,6,6,6,9,9,9,9,9,4,4,4,4,4],
  [2,2,2,2,2,4,4,4,4,4,5,5,5,5,5,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,3,3,3,3,3],
  [10,10,10,10,10,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,10,10,10,10,10,2,2,2,2,2,2,2,2,2,2],
  [6,6,6,6,6,4,4,4,4,4,1,1,1,1,1,7,7,7,7,7,10,10,10,10,10,2,2,2,2,2,9,9,9,9,9],
  [4,4,4,4,4,1,1,1,1,1,3,3,3,3,3,1,1,1,1,1,5,5,5,5,5,5,5,5,5,5,9,9,9,9,9],
  [8,8,8,8,8,6,6,6,6,6,3,3,3,3,3,5,5,5,5,5,8,8,8,8,8,5,5,5,5,5,5,5,5,5,5],
  [8,8,8,8,8,2,2,2,2,2,8,8,8,8,8,10,10,10,10,10,8,8,8,8,8,7,7,7,7,7,5,5,5,5,5],
  [8,8,8,8,8,4,4,4,4,4,6,6,6,6,6,1,1,1,1,1,3,3,3,3,3,7,7,7,7,7,6,6,6,6,6],
  [6,6,6,6,6,10,10,10,10,10,3,3,3,3,3,1,1,1,1,1,5,5,5,5,5,2,2,2,2,2,7,7,7,7,7],
  [3,3,3,3,3,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,5,5,5,5,5,1,1,1,1,1],
  [4,4,4,4,4,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7],
  [7,7,7,7,7,1,1,1,1,1,10,10,10,10,10,10,10,10,10,10,3,3,3,3,3,3,3,3,3,3,7,7,7,7,7],
  [6,6,6,6,6,8,8,8,8,8,5,5,5,5,5,3,3,3,3,3,2,2,2,2,2,5,5,5,5,5,3,3,3,3,3],
  [2,2,2,2,2,4,4,4,4,4,9,9,9,9,9,2,2,2,2,2,1,1,1,1,1,9,9,9,9,9,3,3,3,3,3],
  [5,5,5,5,5,7,7,7,7,7,2,2,2,2,2,9,9,9,9,9,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4],
  [7,7,7,7,7,7,7,7,7,7,1,1,1,1,1,5,5,5,5,5,2,2,2,2,2,9,9,9,9,9,5,5,5,5,5],
  [7,7,7,7,7,6,6,6,6,6,9,9,9,9,9,1,1,1,1,1,8,8,8,8,8,6,6,6,6,6,1,1,1,1,1],
  [2,2,2,2,2,9,9,9,9,9,5,5,5,5,5,2,2,2,2,2,2,2,2,2,2,6,6,6,6,6,1,1,1,1,1],
  [9,9,9,9,9,7,7,7,7,7,4,4,4,4,4,5,5,5,5,5,7,7,7,7,7,5,5,5,5,5,4,4,4,4,4],
  [4,4,4,4,4,7,7,7,7,7,4,4,4,4,4,9,9,9,9,9,4,4,4,4,4,9,9,9,9,9,9,9,9,9,9],
  [4,4,4,4,4,2,2,2,2,2,10,10,10,10,10,10,10,10,10,10,8,8,8,8,8,10,10,10,10,10,1,1,1,1,1],
  [2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,9,9,9,9,9,5,5,5,5,5,10,10,10,10,10,5,5,5,5,5],
  [9,9,9,9,9,6,6,6,6,6,9,9,9,9,9,8,8,8,8,8,1,1,1,1,1,8,8,8,8,8,5,5,5,5,5],
  [1,1,1,1,1,8,8,8,8,8,1,1,1,1,1,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,1,1,1,1,1],
  [1,1,1,1,1,5,5,5,5,5,7,7,7,7,7,10,10,10,10,10,3,3,3,3,3,3,3,3,3,3,8,8,8,8,8],
  [6,6,6,6,6,10,10,10,10,10,1,1,1,1,1,2,2,2,2,2,6,6,6,6,6,4,4,4,4,4,8,8,8,8,8],
  [10,10,10,10,10,10,10,10,10,10,8,8,8,8,8,7,7,7,7,7,8,8,8,8,8,1,1,1,1,1,6,6,6,6,6],
  [8,8,8,8,8,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,7,7,7,7,7,6,6,6,6,6,10,10,10,10,10],
  [1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,8,8,8,8,8,6,6,6,6,6,7,7,7,7,7,3,3,3,3,3],
  [1,1,1,1,1,4,4,4,4,4,6,6,6,6,6,9,9,9,9,9,3,3,3,3,3,10,10,10,10,10,10,10,10,10,10],
  [10,10,10,10,10,10,10,10,10,10,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,1,1,1,1,1,5,5,5,5,5],
  [8,8,8,8,8,7,7,7,7,7,1,1,1,1,1,10,10,10,10,10,6,6,6,6,6,3,3,3,3,3,2,2,2,2,2],
  [9,9,9,9,9,2,2,2,2,2,8,8,8,8,8,1,1,1,1,1,2,2,2,2,2,4,4,4,4,4,9,9,9,9,9],
  [2,2,2,2,2,1,1,1,1,1,10,10,10,10,10,8,8,8,8,8,8,8,8,8,8,4,4,4,4,4,9,9,9,9,9],
  [1,1,1,1,1,5,5,5,5,5,2,2,2,2,2,4,4,4,4,4,3,3,3,3,3,9,9,9,9,9,3,3,3,3,3],
  [8,8,8,8,8,2,2,2,2,2,9,9,9,9,9,8,8,8,8,8,9,9,9,9,9,2,2,2,2,2,3,3,3,3,3],
  [9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,10,10,10,10,10],
  [8,8,8,8,8,3,3,3,3,3,5,5,5,5,5,2,2,2,2,2,5,5,5,5,5,8,8,8,8,8,2,2,2,2,2],
  [8,8,8,8,8,5,5,5,5,5,10,10,10,10,10,10,10,10,10,10,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4],
  [7,7,7,7,7,1,1,1,1,1,8,8,8,8,8,10,10,10,10,10,2,2,2,2,2,3,3,3,3,3,6,6,6,6,6],
  [9,9,9,9,9,3,3,3,3,3,10,10,10,10,10,4,4,4,4,4,10,10,10,10,10,7,7,7,7,7,8,8,8,8,8],
  [6,6,6,6,6,10,10,10,10,10,8,8,8,8,8,6,6,6,6,6,9,9,9,9,9,8,8,8,8,8,7,7,7,7,7],
  [8,8,8,8,8,9,9,9,9,9,3,3,3,3,3,4,4,4,4,4,8,8,8,8,8,7,7,7,7,7,3,3,3,3,3],
  [6,6,6,6,6,1,1,1,1,1,3,3,3,3,3,1,1,1,1,1,4,4,4,4,4,2,2,2,2,2,7,7,7,7,7],
  [7,7,7,7,7,6,6,6,6,6,1,1,1,1,1,2,2,2,2,2,7,7,7,7,7,3,3,3,3,3,6,6,6,6,6],
  [2,2,2,2,2,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,8,8,8,8,8,5,5,5,5,5,6,6,6,6,6],
  [10,10,10,10,10,4,4,4,4,4,7,7,7,7,7,4,4,4,4,4,3,3,3,3,3,7,7,7,7,7,1,1,1,1,1],
  [3,3,3,3,3,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,8,8,8,8,8,5,5,5,5,5,9,9,9,9,9],
  [6,6,6,6,6,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,10,10,10,10,10,4,4,4,4,4,8,8,8,8,8],
  [2,2,2,2,2,1,1,1,1,1,10,10,10,10,10,7,7,7,7,7,9,9,9,9,9,8,8,8,8,8,4,4,4,4,4],
  [1,1,1,1,1,6,6,6,6,6,7,7,7,7,7,9,9,9,9,9,7,7,7,7,7,8,8,8,8,8,7,7,7,7,7],
  [6,6,6,6,6,1,1,1,1,1,7,7,7,7,7,6,6,6,6,6,6,6,6,6,6,1,1,1,1,1,7,7,7,7,7],
  [9,9,9,9,9,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,1,1,1,1,1,8,8,8,8,8,9,9,9,9,9],
  [1,1,1,1,1,5,5,5,5,5,8,8,8,8,8,4,4,4,4,4,1,1,1,1,1,3,3,3,3,3,1,1,1,1,1],
  [5,5,5,5,5,5,5,5,5,5,8,8,8,8,8,5,5,5,5,5,8,8,8,8,8,9,9,9,9,9,7,7,7,7,7],
  [7,7,7,7,7,7,7,7,7,7,3,3,3,3,3,3,3,3,3,3,10,10,10,10,10,10,10,10,10,10,1,1,1,1,1],
  [2,2,2,2,2,8,8,8,8,8,6,6,6,6,6,7,7,7,7,7,10,10,10,10,10,3,3,3,3,3,4,4,4,4,4],
  [9,9,9,9,9,1,1,1,1,1,5,5,5,5,5,6,6,6,6,6,1,1,1,1,1,2,2,2,2,2,4,4,4,4,4],
  [6,6,6,6,6,10,10,10,10,10,1,1,1,1,1,8,8,8,8,8,4,4,4,4,4,8,8,8,8,8,9,9,9,9,9]
]

number_of_students = len(students)
number_of_groups = len(students[0])
group_size = number_of_students / number_of_groups

# create student integer literals
lits = []
for i in range(number_of_students):
  lits += [[]]
  for j in range(number_of_groups):
    lits[i] += ([Int('s_%i_%i' % (i,j))])

# declare satisfaction literal
satisfaction = Int('satisfaction')

# create optimizer
opt = Optimize()

# each student must be assigned to a 'positive' group
for i in range(number_of_students):
  for j in range(number_of_groups):
    opt.add(lits[i][j] >= 0)

# each student is only assigned to one group (row)
for i in range(number_of_students):
  opt.add(Sum(lits[i]) == 1)

# each group has group_size +/- 1 number of students (col)
for i in range(number_of_groups):
  temp = []
  for j in range(number_of_students):
    temp.append(lits[j][i]) 
  opt.add(And(Sum(temp) >= group_size -1), (Sum(temp) <= group_size +1))

# construct a string which defines and adds the satisfaction literal
# calculated by linear combination of likert scores and group assignment
# (assigned: 1 * likert score, not assigned: 0 * likert score)
add_satisfaction_str = "opt.add(satisfaction == "
for i in range(number_of_students):
  for j in range(number_of_groups):
    add_satisfaction_str += "students[%i][%i] * lits[%i][%i] + " % (i,j,i,j) 
add_satisfaction_str = add_satisfaction_str[:-3] + ")"

# executes the above string to add the satisfaction literal
exec(add_satisfaction_str)

# maximize satisfaction
opt.maximize(satisfaction)

# creates a list for displaying groups
groups = [[] for i in range(number_of_groups)]

# counts satisfaction for displaying final result
student_sat_total = 0
student_sat_max_total = 0

# solve, optimize and display the model
# displays student assignments, group assignments and the final satisfaction value
if(str(opt.check()) == 'sat'):
    model = opt.model()
    for i in range(number_of_students):
        for j in range(number_of_groups):
            if int(model.evaluate(lits[i][j]).as_string()) != 0:
                student_sat = students[i][j]
                student_sat_max = max(students[i])
                student_sat_total += student_sat
                student_sat_max_total += student_sat_max
                print(f"Student {i} assigned to group {j} (topic preference: {student_sat}/{student_sat_max})")
                groups[j].append(i)
    for k in range(number_of_groups):
        print(f"Students in group {k}: {groups[k]}")
    print(f"{number_of_students} Students, total student satisfaction: {student_sat_total}/{student_sat_max_total}")
else:
  print("unsatisfiable, check your data, such as too many/few students for the number of groups")

print(f"Exec time: {time.time() - start_time} seconds")
